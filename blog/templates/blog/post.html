{% extends 'nucleo/base.html' %}

{% load static %}

{% block title %}Blog{% endblock %}

{% block content %}
    <script>
        function oucltarComentBox() {
            var x = document.getElementById("comentarioBox");
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        }
    </script>
    <br>
    <section class="page-section cta">
        <div class="container">
            <div class="card">
                {% if post.imagen %}
                    <img class="card-img-top mt-2" style="width: 50%; margin: 0 auto;" src="{{post.imagen.url}}" alt="Card image cap">
                {% endif %}
                <div class="card-body">
                    <h3 class="card-title text-center">{{post.titulo}}</h3>
                    <p class="card-text">{{post.contenido|linebreaks}}</p>
                    <span class="section-heading-under text-center">Publicado por {{post.autor}}.
                        {% for categoria in post.categorias.all %}
                        <a href="{% url 'categoria' categoria.id %}" class="link">{{categoria.nombre}}</a>{% if not forloop.last %},{% endif %}
                        {% endfor %}
                    </span>
                    <br>
                    <a onclick="oucltarComentBox()" style="color: white;" class="btn btn-primary">Comentar post</a>
                    <a href="{% url 'editpost' post.id %}" class="btn btn-primary">Modificar</a>
                </div>
            </div>
            
            <br>

            <div id="comentarioBox" style="display: none;">
                <hr>
                <form action="{% url 'addcomentario' post.id %}" method='POST' enctype="multipart/form-data">{% csrf_token %}
                    {{form.as_p}}
                    <input type="submit" value="Comentar"/>
                </form>
            </div>

            <hr>

            <div>
                {% for comentario in comentarios|dictsort:"id" reversed %}
                <br>
                <div class="card">
                    <div class="card-body row" style="background-color: blue;">
                        <div clas="col-md-8" style="background-color: red;">
                            <p class="card-text  float-left"><span>{{comentario.contenido|linebreaks}}</span></p>
                        </div>
                        <div class="col-md-4 float-right" style="background-color: yellow;">
                            {% if comentario.imagen %}
                                <a href="{{comentario.imagen.url}}"><img style="width: 20%; margin: 0 auto;" src="{{comentario.imagen.url}}" alt="Card image cap"></a>
                            {% endif %}
                            <a>Publicado por, <span>{{comentario.autor}}</span></a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
{% endblock %}